\documentclass{jarticle}
\usepackage{mabst}
\usepackage[dvipdfmx]{graphicx}
\usepackage{latexsym}
\usepackage{here}

\usepackage{comment}
\usepackage{cite}
\usepackage{url}
\usepackage{hhline}
\usepackage{makecell}



\begin{comment}

\end{comment}


\title{2D-LiDARを用いた足元計測に基づく歩行者追跡と三次元全身骨格推定}



\newcommand{\ID}{24MM322}
\newcommand{\Name}{廣中 優平}
\newcommand{\Teacher}{小林 貴訓}



\begin{comment}

めも

来週のミーティングまでに中間審査の予稿の
１. はじめに ２. 提案手法 ３. 実験（計画）を書いてもらえませんでしょうか。
はじめに まあいまのままでいいか
提案手法 こんなシステムですよ
MOTのなかでByteTrackを使います

本研究では，カメラ画像に対する複数物体追跡の技 術を 2D-LiDAR 画像に応用することで，頑健な歩行 者検出・追跡システムの実現を目指している.MOT アルゴリズムの中で，視覚的特徴量を使わないことか ら ByteTrack [15] のアルゴリズムを導入することとし た.これは，2D-LiDAR 画像はカメラ画像と比べて極 めて情報量が少なく，特徴を抽出することが難しいと 考えたからである.検出器にも従来の ByteTrack と同 様に YOLOX [16] を用いる.2D-LiDAR 画像中の人 物を検出するために，実際に歩行の様子を 2D-LiDAR で撮影した画像を学習データとして用いる.

実験 こんな実験で性能評価します

￥￥￥￥￥￥￥￥￥ここまでv0


￥￥￥￥￥￥￥￥￥ここからv1

はじめに




\end{comment}



\begin{document}
\maketitle

\section{はじめに}
人の動きを計測することは，様々な場面で非常に重要である．近年では公共空間で人と共存するロボットも多く登場し，人の位置を正しく検出・追跡したり，個人の振る舞いを理解することの重要性は一層増している．
現在行われている人物計測の多くは，カメラ画像を用いて行われている．カメラ画像は情報量が多く，正確な計測を行うことができる．
一方で，公共空間での撮影においては，不特定多数の人物の顔などが記録されるため，プライバシーの問題が発生する．


以前より我々の研究室では，足元の高さに設置した2D-LiDARを用いることで，前述の問題の解消を目指してきた\cite{hasan2021person}．
水平面上の点群を高速に計測できる2D-LiDARを足元に設置することで，過分なプライバシー情報を取得することなく，歩行の様子を計測できる．これまでには，クラスタリングを用いた人物検出とカルマンフィルタによる追跡を用いて，精度の高い歩行者追跡が実現されてきた．一方で，複数人が歩行する場合に遮蔽が多発すると追跡性能が落ちる点，クラスタリングの処理速度が遅くリアルタイムでの追跡には向かない点などが問題点として挙げられていた．



%また，2D-LiDARは移動ロボットに標準的に搭載されており，移動ロボットにセンサを追加することなく周囲の人物の歩行計測が可能となる．



% \begin{figure}[H]
%      \centering
%      \includegraphics[width=230pt]{image_Sensing_neo.png}
%      \caption{2D-LiDARによる足元計測の様子}
%      \label{fig:sensing}
% \end{figure}


また，人物の振る舞いを計測する手法として，2D-LiDARを使って歩行者の全身骨格を推定する研究も行われてきた\cite{suda_d}．足元の高さに設置した2D-LiDARのみを用いて，人物の全身骨格を推定できる．2D-LiDARによって得られた歩行の様子を表す画像と，Kinectから取得した骨格情報を組み合わせて深層学習を行い，得られたモデルを使って推定を行う．足元情報のみから全身の骨格を推定することは，プライバシーに配慮した人物の振る舞いの計測につながる．

% \begin{figure}[H]
%      \centering
%      \includegraphics[width=230pt]{image_Sensing_neo.png}
%      \caption{骨格推定の様子}
%      \label{fig:sensing}
% \end{figure}

これらの技術はどれも非常に有用なものである．一方で，性能に不足がある点，リアルタイムで動作しない点，それぞれが個別に実装されている点など，実用に向けていくつかの解消すべき問題点がある．



%本研究では，カメラ画像に対する複数物体追跡の技術であるMOT (Multi Object Tracking)を2D-LiDAR画像に応用することで，前述の問題点の解消を目指す．これまでに提案されてきたMOTアルゴリズムの中で，視覚的特徴量を使わないことからByteTrack\cite{zhang2022bytetrack}のアルゴリズムを導入することとした．これは，2D-LiDAR画像はカメラ画像と比べて極めて情報量が少なく，特徴を抽出することが難しいと考えられるためである．

本研究では，歩行者追跡におけるいくつかの問題を解消すると共に，既存の骨格推定手法との融合を図っていく．2D-LiDARによって足元の様子を計測し，歩行者の検出と追跡を行う．更に，検出された人物の歩行の様子から三次元骨格を推定する．この一連の流れを同時に実行できる，実用性の高いシステムを目指す．



\section{提案手法}

% 歩行者追跡における諸問題の解消に向けて，カメラ画像に対する複数物体追跡の技術であるMOT (Multi Object Tracking)を導入する．
% これまでに提案されてきたMOTアルゴリズムの中で，視覚的特徴量を使わないByteTrack\cite{zhang2022bytetrack}を採用した．従来のByteTrackと同様に，検出にはYOLOX\cite{ge2021yolox}，追跡にはBYTEアルゴリズムを用いる．BYTEアルゴリズムは追跡対象が遮蔽される場面の多い環境に適しており，複数人が歩行する場合の追跡性能向上が期待される．また，従来のクラスタリングを用いた手法と比べて処理速度が高く，リアルタイムでの追跡が可能になると考えられる．


%これは，2D-LiDAR画像はカメラ画像と比べて極めて情報量が少なく，特徴を抽出することが難しいためである．
足元に設置した2D-LiDARを用いて，歩行者追跡と全身骨格推定を同時に行うシステムを提案する．

\begin{figure}[H]
     \centering
     \includegraphics[width=230pt]{test6.png}
     \caption{提案するシステムの概要}
     \label{fig:sensing}
\end{figure}


2D-LiDARによって取得した距離データを直交座標系へ変換した上で，対象の動きを1枚の画像で表現するMHI(Motion History Image)を作成する．MHIは，複数のフレームを重ね合わせ，現在のフレームに近いほど明るく，過去のフレームほど暗く描画することで，対象の動きを1枚の画像で表現する手法である．

歩行者の検出・追跡においては，カメラ画像に対する複数物体追跡の技術であるMOT (Multi Object Tracking)を導入した．
MOTアルゴリズムの中で，視覚的特徴量を使わないByteTrack\cite{zhang2022bytetrack}を採用する．ByteTrackで用いられるBYTEアルゴリズムは，追跡対象が遮蔽されることの多い環境に適しており，複数人が歩行する場合の追跡性能向上が期待される．また，従来のクラスタリングとカルマンフィルタを用いた手法と比べて処理速度が高く，リアルタイムでの追跡が可能になると考えられる．



% 1フレームのみの一般的な画像と比べて動きに関する情報量が増え，高い精度での人物検出ができる．



また，検出・追跡のために作成したMHIを流用して，歩行者の三次元骨格推定を同時に行う．YOLOXによる検出に基づいて，計測域全体の画像から人物と思われる部分のMHIを切り出し，学習されたモデルを使って骨格を推定する．今回は新たに学習は行わず，これまでの研究で得られたモデルを使用する\cite{suda_d}．





%検出器には従来のByteTrackと同様にYOLOX\cite{ge2021yolox}を用いる．2D-LiDAR画像中の人物を検出するために，実際に歩行の様子を2D-LiDARで撮影した画像からMHIを作成し学習を行う．

%実際に歩行を追跡する際は，あらかじめ記録したデータに対して追跡を行う他に，リアルタイムで追跡を行うことも可能とした．従来の手法と合わせて，次章にて性能比較を行う．


%これまでに提案されてきたMOTアルゴリズムの中で，視覚的特徴量を使わないことからByteTrack\cite{zhang2022bytetrack}のアルゴリズムを導入することとした．これは，2D-LiDAR画像はカメラ画像と比べて極めて情報量が少なく，特徴を抽出することが難しいと考えられるためである．



\section{実験}

 \subsection{検出・追跡の性能評価}
まず，歩行者検出・追跡の性能を確認する．
実際に複数人が歩行する環境を計測し，検出と追跡を行った．4m×8mのエリア内において，それぞれ与えられたパターンに従って4人が歩行し，その様子を足元の高さに設置した1台の2D-LiDARによって測定する(図\ref{fig:walking})．

\begin{figure}[H]
     \centering
     \includegraphics[width=220pt]{tracking2.png}
     \caption{複数人の歩行を計測する様子}
     \label{fig:walking}
\end{figure}




従来のクラスタリングとカルマンフィルタを組み合わせたシステムと，今回提案するByteTrackベースのシステムのそれぞれを用いて，同じ歩行に対して検出・追跡を行う．
どちらの手法も，多くのフレームで正しく人物を検出できた．一方で，追跡性能には差が見られた．従来の手法では，他の人の影に入った時や複数人が接近した時に検出が失われた後，違うIDが付与されてしまう場合が多かった．ByteTrackを用いた提案手法では，検出に失敗するフレームがあったとしても，正しいIDを再び付与できる場面が多かった．


 % 複数物体追跡において一般的な評価指標であるIDF1を用いて定量的な評価を行った\cite{bernardin2008evaluating}．結果を下に示す．

% 複数物体追跡において一般的な評価指標であるMOTA・IDF1・HOTAを用いて定量的な評価を行った\cite{bernardin2008evaluating}．



% \begin{table}[H]
%     \centering
%     \caption{精度評価}
    
%     \begin{tabular}{|l||r|r|r||r|}\hline
%          & FP & FN & IDsw & IDF1 \\ \hhline{|=|=|=|=|=|}
%         クラスタリング & 37 & 153 & 8 & 0.630 \\ \hline 
%         ByteTrack & 63 & 652 & 6 & 0.903 \\ \hline
        
    
%     \end{tabular}
%     \label{tab:score}
% \end{table}

% \begin{table}[H]
%     \centering
%     \caption{精度評価}
    
%     \begin{tabular}{|l||r|r|r|}\hline
%          & MOTA & IDF1  \\ \hhline{|=|=|=|}
%         クラスタリングベース & 要計算 & 0  \\ \hline 
%         ByteTrack(録画データ)& 0 & 0 \\ \hline
%         ByteTrack(リアルタイム)  & 0 & 0 \\ \hline
        
    
%     \end{tabular}
%     \label{tab:score}
% \end{table}


% \begin{table}[H]
%     \centering
%     \caption{精度評価}
    
%     \begin{tabular}{|l||r|r|r|}\hline
%          & MOTA & IDF1  \\ \hhline{|=|=|=|}
%         クラスタリング（従来手法） & 0.848 & 0.903  \\ \hline 
%         ByteTrack（提案手法）  & 0.958 & 0.630 \\ \hline
        
    
%     \end{tabular}
%     \label{tab:score}
% \end{table}


% \begin{table}[H]
%     \centering
%     \caption{精度評価}
    
%     \begin{tabular}{|l||r|r|r|}\hline
%          & MOTA & IDF1 & HOTA  \\ \hhline{|=|=|=|=|}
%         クラスタリング（従来手法） & 0.958 & 0.630 & 0.688  \\ \hline 
%         ByteTrack（提案手法 & 0.848 & 0.903 & 0.823 \\ \hline
        
    
%     \end{tabular}
%     \label{tab:score}
% \end{table}

\begin{table}[H]
    \centering
    \caption{検出・追跡の定量評価}
    \label{tab:score}
    \begin{tabular}{|l||c|c|c|}
        \hline
        & MOTA & IDF1 & HOTA \\ \hhline{|=|=|=|=|}
        \makecell{クラスタリング \\ +カルマンフィルタ } & \textbf{0.958}  & 0.630 & 0.688 \\
        \hline
        \makecell{ByteTrack } & 0.848 & \textbf{0.903}  & \textbf{0.823}  \\
        \hline
    \end{tabular}
\end{table}


複数物体追跡における一般的な評価指標を用いて定量的な評価を行った\cite{bernardin2008evaluating}．検出の正確性を重視するMOTAでは，従来の手法の方が高い数値となった．提案手法のYOLOXを用いた人物検出では，遮蔽などで足の形がはっきり見えていない場面などで検出できない場合があるため，MOTAは低くなってしまったと考えられる．

一方で，追跡の持続性を重点的に評価するIDF1やHOTAでは，従来の手法と比べて非常に高い数値を得ることができた．検出が失われる場面でもIDの切り替えが少なかったことに起因していると考えられ，持続性の高い追跡が実現できていると言える．

\subsection{骨格推定の性能評価}
次に，三次元全身骨格推定に関して評価を行う．今回は，1人の直進歩行に対して，歩行者検出・追跡と同時に骨格推定を実行した(図\ref{fig:ske})．

\begin{figure}[H]
     \centering
     \includegraphics[width=220pt]{sketest3.png}
     \caption{骨格推定の様子}
     \label{fig:ske}
\end{figure}

検出・追跡と同時に，骨格推定もリアルタイムで実行することができた．そして，学習用に用意したMHIではなく，YOLOXによる検出に基づいて切り出したMHIでも，おおよそ歩行の様子がわかるような推定が行えることがわかった．
一方で，崩れた骨格が出力されるフレームも多くあった．骨格推定に用いるモデルの性能の向上に加えて，より学習データに近い状態のMHIを作成することが求められると考えている．

\section{おわりに}


本稿では，2D-LiDARによる足元計測データを利用して，歩行者追跡と三次元全身骨格推定を行うシステムを提案した．ByteTrackの導入により，従来のシステムよりも持続性の高い歩行者追跡を，リアルタイムで行うことが可能になった．
また，追跡と同時に全身骨格の推定が行えることも確認できた．一方で，骨格推定の精度は向上させる必要がある．

今後は，骨格推定に用いるMHIの処理方法の改善の検討など，推定の精度向上に取り組んでいきたい．また，複数人が同時に歩行する場合における骨格推定にも取り組んでいく．さらに，検出・追跡と骨格推定を組み合わせたわかりやすい表示方法の検討や，システム全体の処理速度向上にも取り組んでいきたい．










\footnotesize
\bibliographystyle{junsrt}
\bibliography{books}

\end{document}

