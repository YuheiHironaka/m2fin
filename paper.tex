\documentclass[12pt,epsf,dvipdfmx]{jreport}
% \usepackage{graphicx} % 図の貼り付け用 (ics.styで読み込まれているためコメントアウト)
\usepackage{ics} % ICS卒論・修論スタイルファイル
\usepackage{makeidx} %索引生成用パッケージ
\usepackage{tabularx}% 横幅指定で表を作成
\usepackage{latexsym} % 数学記号用パッケージ

\usepackage{hhline}
\usepackage{here}

\usepackage{url}
\urlstyle{same}


\newtheorem{definition}{定義}[chapter]
\newtheorem{algorithm}{アルゴリズム}[chapter]

%% end of local definitions

\def\epsfsize#1#2{\ifnum#1>\hsize\hsize\else#1\fi}

\begin{document}

% \papercode{ICS-xxM-yyyyyyy} % 論文番号については、「論文番号および論文ファイル名について」のwebページを確認してください。
% \title{卒業論文、修士論文のタイトル}
% % \affiliation{工学部情報工学科}
% \affiliation{理工学研究科 数理電子情報専攻\\情報工学プログラム}
% % \affiliation{理工学研究科 数理電子情報コース}
% \author{氏 名}
% \date{令和7年2月10日提出}
% \supervisor{○○ ☆☆教授}
% \labname{○○研究室}
% \studentID{yyyyyyy}
% \maketitle

\papercode{ICS-24B-065}
\title{深層学習を用いた2D-LiDARによる歩行者追跡の高度化}
\affiliation{理工学研究科 数理電子情報専攻\\情報工学プログラム}
\author{廣中 優平}
\date{令和8年2月1日提出}
\supervisor{小林 貴訓教授}
\labname{小林研究室}
\studentID{24MM322}
\maketitle

\setcounter{page}{1}
\chapter*{概要}
 \pagenumbering{roman} % 消さない
 \addcontentsline{toc}{chapter}{概要} %消さない

人物の動きを計測することは，様々な場面で非常に重要である．近年では人と共存するロボットも多く登場し，人の位置を正しく検出・追跡したり，個人の振る舞いを理解することの重要性は一層増している．現在行われている人物計測の多くは，カメラ画像を用いて行われている．カメラ画像は情報量が多く，正確な計測を行うことができる．一方で，公共空間での撮影においては，不特定多数の人物の顔などが記録されるため，プライバシーの問題が発生する．

以前より我々の研究室では，足元の高さに設置した2D-LiDARを用いることで，前述の問題の解消を目指してきた\cite{hasan2021person}．水平面上の点群を高速に計測できる2D-LiDARを足元に設置することで，過分なプライバシー情報を取得することなく，歩行の様子を計測できる．これまでには，クラスタリングを用いた人物検出とカルマンフィルタによる追跡を用いて，精度の高い歩行者追跡が実現されてきた．一方で，複数人が歩行する場合に遮蔽が多発すると追跡性能が落ちる点，クラスタリングの処理速度が遅くリアルタイムでの追跡には向かない点などが問題点として挙げられていた．

また，人物の振る舞いを計測する手法として，2D-LiDARを使って歩行者の全身骨格を推定する研究も行われてきた\cite{s_b}．足元の高さに設置した2D-LiDARのみを用いて，人物の全身骨格を推定できる．2D-LiDARによって得られた歩行の様子を表す画像と，Kinectから取得した骨格情報を組み合わせて深層学習を行い，得られたモデルを使って推定を行う．足元情報のみから全身の骨格を推定することは，プライバシーに配慮した人物の振る舞いの計測につながる．

これらの技術はどれも非常に有用なものである．一方で，性能に不足がある点，リアルタイムで動作しない点，それぞれが個別に実装されている点など，実用に向けていくつかの解消すべき問題点がある．本研究では，歩行者追跡におけるいくつかの問題を解消すると共に，既存の骨格推定手法との融合を図っていく．2D-LiDARによって足元の様子を計測し，歩行者の検出と追跡を行う．更に，検出された人物の歩行の様子から三次元骨格を推定する．この一連の流れを同時に実行できる，実用性の高いシステムを目指した．

本研究の取り組みは，従来の歩行者検出・追跡の性能向上と，歩行者検出・追跡と骨格推定を組み合わせた統合的なシステムの実装の2つに分けられる．本稿では，歩行者検出・追跡の性能向上について，ByteTrackをベースとした2D-LiDARによる歩行者追跡の性能を定量的に評価し，従来手法との比較を行った．また，骨格推定手法と統合した統合システムについて，実装したシステムを用いて複数人の歩行計測を行い，性能を確認した．




%%% 謝辞 %%%

\chapter*{謝辞}
\addcontentsline{toc}{chapter}{謝辞} % 消さない

%卒論の謝辞
研究ならびに生活面においてご指導を賜りました小林教授，鈴木助教に深く感謝致します．

また，先輩としていつもよきアドバイスをくださり，快くデータを提供してくださりました須田悠介氏をはじめとする研究室の皆様，そして同期学生の皆様，並びに私を暖かく見守って頂いた両親はじめとする周囲のすべての皆様に深く感謝致します．

\tableofcontents % 目次生成
\listoffigures % 図目次生成
\addcontentsline{toc}{chapter}{図目次}
\listoftables % 表目次生成
\addcontentsline{toc}{chapter}{表目次}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{はじめに}
\pagenumbering{arabic} %消さないこと
\setcounter{page}{1}   %消さないこと

       \section{背景}
       人物の動きを正しく計測することは，様々な場面で非常に重要になっている．複数人物の位置を正しく検出・追跡したり，それぞれの振る舞いを理解することは，公共空間における空間利用の最適化や，利用者の利便性向上に向けた環境設計において重要な役割を果たす．
       また，近年では人と共存するロボットも多く登場し，それらの振る舞いを最適化する際にも人物の行動を正しく理解することが求められる．

       複数人物の行動理解には，カメラ画像が用いられることが多い．カメラ画像は情報量が多いため，簡単に行動の解析ができる．一方で，公共空間での撮影ではプライバシーの問題が発生する．不特定多数が利用する公共空間において，カメラ画像による計測を行うと，顔などの重要度の高い個人情報を収集することなる．カメラ画像を用いて歩行者計測を行う場合は，個人が特定されない形での情報処理や利用用途の正しい告知などが求められ，計測を行うハードルが高い．


       \section{目的}
       本研究では，人流計測やロボットの振る舞い向上に向けた人物の行動計測手法として，足下の高さに設置した2D-LiDARで取得できるデータを使って，歩行者の行動を理解するシステムの実現を目指す．2D-LiDARで取得するのは足元の距離データのみであり，カメラ画像と比べると情報量が極めて少ない．プライバシーに関して考慮すべき事項が減ることで，様々な場面で歩行者計測が容易に行えるようになると考える．
       
       本研究の取り組みは，歩行者検出・追跡の性能改善，骨格推定と統合したシステムの実装の2つに分けられる．これまでに小林研究室で行われてきた歩行者検出・追跡の課題を解消し，高速かつ高精度の検出・追跡を実現した．さらに，これまで検出・追跡とは分かれて研究されてきた3次元骨格推定システムを統合することで，検出・追跡と骨格推定を同時にリアルタイムで行える実用性の高いシステムを実現した．
       


       \section{本論文の構成}
       本論文の構成は以下のようになっている．

              第1章 はじめに

              第2章 先行研究

              第3章 システムの概要

              第4章 実験

              第5章 考察

              第6章 おわりに

       第1章では，本研究の背景と目的，そして本論文の構成を説明する．第2章では，これまでに行われてきた人物計測手法について述べる．第3章では，本研究にて目指すシステムの構成を説明する．第4章では，実装したシステムの性能を評価するための実験とその結果について述べる．第5章では，実験の結果を踏まえて考察を行う．第6章では，本稿のまとめと今後の課題について述べる．


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\chapter{先行研究}
本研究で実装する歩行者計測システムに関わる先行研究を紹介する．
       \section{従来の歩行者追跡}
       小林研究室では，以前より足元の高さに設置した2D-LiDARを用いた歩行者追跡が行われている\cite{hasan2021person}\cite{h_b}\cite{h_m}．先行研究では，クラスタリングを用いた検出とカルマンフィルタを用いた追跡によって，歩行者追跡を実現していた．本節では先行研究の概要について説明する．
              \subsection{クラスタリングによる検出}
              先行研究\cite{hasan2021person}\cite{h_b}\cite{h_m}では，クラスタリングを用いて人物の検出を行っていた．クラスタリングアルゴリズムは，DBSCAN\cite{db}をベースとしている．DBSCANはデータの密度を基にクラスタリングを行うアルゴリズムである．
 
              2D-LiDARによって取得された人物の足は，図\ref{fig:dis}のように描画される(本稿ではこれを距離画像と呼ぶ)．距離画像に対してクラスタリングを行うと，正しく人を検出することができない場合がある．右足と左足が離れている場合に2人であると検出してしまう問題や，複数人が近接する場合に1人であると検出してしまう問題が発生する．そこで先行研究では，過去フレームの画像を重ね合わせた画像(図\ref{fig:mhi})(本稿ではこれを時系列画像と呼ぶ)をクラスタリングに用いている．時系列画像は現在の足の位置だけでなく過去の動きを表現できるため，前述の問題を解消できる．

              \begin{figure}[H]
              \centering
              \begin{minipage}{0.4\columnwidth}
                     \centering
                     \includegraphics[width=\columnwidth]{dis.png}
                     \caption[距離画像]{距離画像(\cite{h_m}図3.4より)}
                     \label{fig:dis}
              \end{minipage}
              \hspace{0.04\columnwidth} %
              \begin{minipage}{0.4\columnwidth}
                     \centering
                     \includegraphics[width=\columnwidth]{mhi.png}
                     \caption[時系列画像]{時系列画像(\cite{h_m}図3.4より)}
                     \label{fig:mhi}
              \end{minipage}
              \end{figure}


              \subsection{カルマンフィルタによる追跡}
              クラスタリングによって検出された人物に対して，重心位置を計算してカルマンフィルタを適用する(図\ref{fig:gra}，図\ref{fig:kal})．カルマンフィルタでは，1ステップ前の状態から推定した位置と検出した位置より，現在の推定位置の決定と1ステップ先の推定が行われる．これによって，時間とともに動いていく人物を追跡する．

              以上のような手法によって，2D-LiDARの周辺の歩行者の追跡を行っていた．多くの場合において，複数の人物を正しく追跡することができていた．

              \begin{figure}[H]
              \centering
              \begin{minipage}{0.4\columnwidth}
                     \centering
                     \includegraphics[width=\columnwidth]{gra.png}
                     \caption[重心位置を計算]{重心位置を計算\newline 
                     (\cite{h_m}図3.7より)}
                     \label{fig:gra}
              \end{minipage}
              \hspace{0.04\columnwidth} 
              \begin{minipage}{0.4\columnwidth}
                     \centering
                     \includegraphics[width=\columnwidth]{kal.png}
                     \caption[カルマンフィルタを適用]{カルマンフィルタを適用\newline 
                     (\cite{h_m}図3.8より)}
                     \label{fig:kal}
              \end{minipage}
              \end{figure}

              \subsection{従来手法の課題}
              一方で，先行研究\cite{hasan2021person}\cite{h_b}\cite{h_m}にはいくつかの問題点も存在した．まず，追跡対象が他の人物の影に入って計測されなくなる場合に，追跡をうまく継続できないという課題があった．複数人が歩行するような環境では，遮蔽が発生した場合でも追跡を継続できるようなシステムが求められる．


              \begin{figure}[H]
              \centering
              \begin{center}
              \centering
              \includegraphics[width=453pt]{occ_kal.png}
              \caption{遮蔽によって追跡がうまくいかない様子}
              \label{fig:occ_problem}
              \end{center} 
              \end{figure}


              処理速度も課題となっていた．計測対象が少人数の場合は約30fps程度で追跡できるものの，人数が増えるごとに速度が低下し，7人を計測する際は10-15fpsとなってしまう．時系列画像作成，クラスタリング，カルマンフィルタの適用を並列で行うことで高速化を目指したものの，クラスタリングがボトルネックとなり高速化は実現できなかった．
              

       \section{ByteTrack}
       カメラ画像に対する複数物体追跡は，Multi Object Tracking（MOT）と総称され，様々な手法が提案されている．本研究では，その中でも極めて高い性能を発揮することで知られるByteTrack\cite{ByteTrack}のアルゴリズムを，2D-LiDAR画像に適用することを考えた．本節ではByteTrackの概要を紹介する．

              \subsection{Multi Object Tracking}
              MOT技術とは複数物体追跡技術の総称である．MOT技術の多くは，検出(Detection)と追跡(Tracking)を切り離して考える，Tracking By Detectionという考え方を用いている．Trackingは，あるフレームで検出された物体と次のフレームで検出された物体同士をIDで紐づけることの繰り返しである．多くのMOT手法は，Trackingアルゴリズムの独自性に重点を置いている．

              Trackingで重要な課題となるのが，追跡対象が影に入った場合の対応である．一度影に入って検出できなくなった物体が，再び影から出てきたとき，影に入る以前と同じIDを付与しなければならない．近年主流になっているMOT手法の多くは，物体の視覚的特徴量を用いてこの課題に対応しようとしている．追跡対象の色や形といった見た目の特徴を保持しておく．それらの視覚的特徴量とカルマンフィルタなどによる予測を組み合わせることで，影に出入りした物体に正しいIDを付与できる確率が高まり，精度の高い追跡が実現できる．

              一方で，2D-LiDAR画像は周囲の物体との距離のみを示すため，カメラ画像と比べて視覚的な特徴量が極めて少ない．したがって，本研究において視覚的特徴量を使うアルゴリズムの導入は難しいと考えられた．そこで，本研究ではByteTrack\cite{ByteTrack}と呼ばれる手法を採用した．ByteTrackは，Trackingに視覚的特徴量を用いないにも関わらず，非常に高い性能を発揮できる手法として知られている．


              \subsection{BYTEアルゴリズム}
              ByteTrack\cite{ByteTrack}は，検出にYOLOX\cite{ge2021yolox}，追跡にBYTEアルゴリズムを用いたトラッカーの名称である．ここでは，ByteTrackの鍵となっているBYTEアルゴリズムについて紹介する．

              一般的なMOTの追跡アルゴリズムでは，閾値よりも信頼度の低い検出を切り捨てて追跡を行う．図\ref{fig:com}は，複数人が歩くカメラ映像に対して，一般的なアルゴリズムが検出と追跡を行っている様子である．Frame \(t_1\)において，真ん中を歩く人は信頼度0.8として検出され，追跡でも赤い枠で表されている．しかし，Frame \(t_2\)では左の人の影に入って信頼度が0.4に下がり，設定された閾値を下回ってしまったため，追跡は失われてしまっている．この切り捨ては，誤検出を追跡に採用しないようにするために行われる．すべての検出を追跡に採用すると，右端の誤検出も人として追跡されてしまう．

              \begin{figure}[H]
              \centering
              \begin{center}
                     \centering
                     \includegraphics[width=115mm]{com.png}
                     \caption[人物の検出と追跡(BYTEアルゴリズムの場合)]{人物の検出と追跡(一般的なアルゴリズムの場合)\newline (\cite{ByteTrack}図2より)}
                     \label{fig:com}
              \end{center} 
              \end{figure}


              一方で，BYTEアルゴリズムは信頼度の低い検出も追跡に用いる．まず，すべての検出を信頼度の高い検出\(D_{high}\)と低い検出\(D_{low}\)に分ける．それらを用いて，これまでのフレームを踏まえたカルマンフィルタの予測との紐づけを行う．1回目の紐づけでは，信頼度の高い検出\(D_{high}\)のみを使って紐づけを行う．信頼度の高い検出のうち過去の追跡と結びつかなかったものは，新たな追跡対象として追加される．ここまでは従来の方法と同様である．続いて，1回目の紐づけで結びつかなかった予測と信頼度の低い検出\(D_{low}\)の紐づけを行う．ここで結びつかなかった検出は切り捨てられる．以上のような流れで紐づけを行うことで，信頼度の低い検出\(D_{low}\)も無駄にすることなく追跡が行われる．また，信頼度の低い検出\(D_{low}\)は新たな追跡対象とはならないため，誤検出が追跡につながることも避けられる．

              \begin{figure}[H]
              \centering
              \begin{center}
                     \centering
                     \includegraphics[width=115mm]{bye.png}
                     \caption[人物の検出と追跡(BYTEアルゴリズムの場合)]{人物の検出と追跡(BYTEアルゴリズムの場合)\newline (\cite{ByteTrack}図2より)}
                     \label{fig:bye}
              \end{center} 
              \end{figure}


              \subsection{2D-LiDAR画像への適用}
              BYTEアルゴリズムを導入したByteTrackは，MOTにおけるState-of-the-Artな手法として注目を集めている．一方で，ByteTrackはカメラ画像に対する追跡技術であり，2D-LiDAR画像に対しても同様の追跡を実現できるかどうかは不明である．したがって本研究は，2D-LiDAR画像に対するByteTrackの適用可能性を，実計測データに対する追跡を行うことで検証する．


       \section{骨格推定}
       小林研究室では，2D-LiDARを用いた足下計測データから，歩行者の全身骨格を推定する研究が行われてきた．本節では3次元骨格推定の概要について説明する．



\chapter{システムの概要}


\chapter{実験}
 \section{実験方法}
 実験方法を説明する．

 \section{実験結果}
 実験結果を説明する．                     



\chapter{考察}
考察

\chapter{おわりに}
 \section{まとめ}
 まとめ

 \section{今後の課題}
 今後の課題


\chapter*{公表論文}
\addcontentsline{toc}{chapter}{公表論文}

\begin{list}%
 {} %default label
 {} %formatting parameter
 \item 査読付き論文
       \begin{itemize}
	\item Hogehoge: ....
       \end{itemize}
 \item 査読なし論文
       \begin{itemize}
	\item Hogehoge: ....
       \end{itemize}
\end{list}

\newpage

% 参考文献：bibtexを使う場合
%
\bibliographystyle{junsrt} % bstファイル名
\bibliography{books} % bibファイル名
\label{sannkoubunnkenn_chapter}

% 参考文献：直接記述する場合
% \begin{thebibliography}{99}
% \label{sannkoubunnkenn_chapter}
% 
% %% 程研究室参考文献形式
% 
% % 学術雑誌論文
% \bibitem{tagawa98}
% 多川 孝央, 大堀 順也, 程 京徳, 牛島 和夫: 相関論理における強相関性原理,
%         人工知能学会誌, Vol. 13, No. 3, pp. 387-394, 1998年5月.
% 
% \bibitem{Nonaka99}
% Yusuke NONAKA, Jingde CHENG, and Kazuo USHIJIMA: A Tasking Deadlock
%         Detector for Ada 95 Programs, Ada User Journal, Vol. 20, No. 1,
%         pp. 79-92, April 1999.
% 
% % 単行本
% \bibitem{ChengXX}
% 程 京徳: 相関論理入門, 何らか出版社, 200?年?月.
% 
% \bibitem{Jin01}
% Qun JIN, Jie LI, Nan ZHANG, Jingde CHENG, Clement YU, and Shoichi
%         NOGUCHI: Enabling Society with Information Technology,
%         Springer-Verlag, November 2001.
% 
% \bibitem{Hennessy93}
% Matthew Hennessy著, 荒木 啓二郎, 程 京徳 共訳：
% プログラミング言語の意味論入門, サイエンス社, 1993年12月.
% 
% % 単行本などに編集された章、論文
% \bibitem{Cheng91}
% Jingde CHENG: Relevance Logic and Entailment Logic, in I. Nakada and
%         M. Hagiya (Eds.), ``Software Science and Engineering,''
%         pp. 189-211, World Scientific, November 1991.
% 
% \bibitem{Nonaka00}
% Yusuke NONAKA, Jingde CHENG, and Kazuo USHIJIMA: A Supporting Tool for
%         Development of Self-measurement Ada Programs, in H. B. Keller
%         and E. Ploedereder (Eds.), ``Reliable Software Technologies -
%         Ada-Europe 2000, 5th International Conference on Reliable
%         Software Technologies, Potsdam, Germany, June 2000,
%         Proceedings,'' Lecture Notes in Computer Science, Vol. 1845,
%         pp. 69-81, Springer-Verlag, June 2000.
% 
% % 国際会議、国内シンポジウム論文集論文
% \bibitem{Goto01}
% Yuichi GOTO, Daisuke TAKAHASHI, and Jingde CHENG: Parallel Forward
%         Deduction Algorithms of General-Purpose Entailment Calculus on
%         Shared-Memory Parallel Computers, Proceedings of the ACIS 2nd
%         International Conference on Software Engineering, Artificial
%         Intelligence, Networking \& Parallel/Distributed Computing,
%         pp. 168-175, Nagoya, Japan, August 2001.
% 
% \bibitem{Koide01}
% 小出 雅人, 程 京徳: インターネット上でカードゲームを行うための汎用プロト
%         コル群の開発, 情報処理学会第６回ゲーム・プログラミング国際ワーク
%         ショップ論文集, pp. 78-85, 箱根, 日本, 2001 年10月.
% 
% % 博士，修士，卒業論文
% \bibitem{Goto05}
% 後藤 祐一: 強相関論理に基づいた自動前向き演繹とその応用, 埼玉大学大学院
% 	理工学研究科情報数理科学専攻博士論文,2005年3月.
% 
% \bibitem{Goto02}
% 後藤 祐一: 強相関論理と汎用前向き自動帰結演算システム EnCal を用いた知識
% 	発見, 埼玉大学大学院理工学研究科情報システム工学専攻修士論文,2003年
% 	2月.
% 
% \bibitem{Goto00}
% 後藤 祐一: 汎用前向き自動帰結演算システムEnCalの共有メモリ型並列計算機上
% 	での並列化, 埼玉大学工学部情報システム工学科卒業論文, 2001年2月.
% 
% 
% % 企業や製品のWebページなど
% % \newblockは後ろに続く文字列を一つの塊としてみなす命令
% \bibitem{cem}
% {Common Criteria Project}:
% \newblock CEM v3.1,
% \newblock \\http://www.commoncriteriaportal.org/thecc.html
% 
% \bibitem{ccportal}
% {Common Criteria Project}:
% \newblock Common Criteria Portal,
% \newblock \\http://www.commoncriteriaportal.org/
% 
% \end{thebibliography}

% 付録
\appendix % 以下，付録
\chapter{▽△▽△}
\section{ほげほげ}
\section{ほりゃほりゃ}
\chapter{▽△▽△}
\section{ほげほげ}
\section{ほりゃほりゃ}

% 索引． mendexかmkindexで作成
\printindex

%目次にIndexを表示させる場合はmendexかmkindex実行後に作成される
% hogehoge.idmファイルのtheindex環境の中で下記命令を置く
%\addcontentsline{toc}{chapter}{Index}

\end{document}

