2D-LiDAR を用いた足元計測に基づく三次元全身骨格推定
23MM305
1.

須田 悠介

はじめに

近年，ユーザへのサービスの質を向上させるための

指導教員:

小林 貴訓

3.

データセットの作成

3.1

データの取得

様々な研究が行われている．複数人が混在する環境に

学習データとして，歩行者の正面から骨格情報を，

おいて，それぞれのユーザに個別のサービスを提供し

前後左右の 4 方向から距離情報を取得した．学生 8 人

たり，対象ユーザのみに適切なサービスを提供したり

にそれぞれ 100 回ずつ Kinect に向かって直線に歩行

することが求められている．これらを実現するために

してもらい，データの収集を行った．Kinect は，0.5

は人の行動に加え，年齢や性別などの属性情報が有用

〜4.5m の範囲で人物の骨格推定を行うことができる．

であると考えられる．人の属性を推定する手法には， さらに，Kinect が全身を撮影できるようにするために
一般的な手法としてカメラ画像を用いて歩容解析を行

は少なくとも 2m 程度の距離が必要となる．そこで本

う方法が挙げられるが，プライバシーへの配慮の面か

稿では撮影範囲を Kinect から 2m〜4.5m の範囲に設

ら問題となることも多い．そこで，高精度かつ広域を

定しデータの収集を行った (図 2)．

計測可能でありプライバシーの面でも優位である 2D-

LiDAR を用いることで，プライバシーに配慮した人
物の属性取得を行う手法について研究を行っている．
先行研究では，足元に置いた 2D-LiDAR の距離情
報から，歩行者の追跡およびその身長・年齢の階級を
推定するシステムが提案されている [1]．しかし，足首
の動き情報のみからの歩容解析は限定的であり，身振
り等のより詳細な情報を得ることは困難である．そこ
で，足の動きと手の振り方や大きさには関連があるこ
とに着目し，これらの関係性を学習することで足首の
動きから全身の動きが推測できるのではないかと考え
た．本稿では，人の歩行のメカニズムに基づいて，よ
り具体的な人物の振る舞いや属性の推定を行うため，

図 2: データの取得環境

足元に置いた 2D-LiDAR から全身骨格の三次元推定
を行う．

2.

提案手法

3.2

データの処理

取得したそれぞれのデータは学習しやすいように処
理する．距離情報は，1080 方向の 2D-LiDAR からの

2D-LiDAR と Kinect を設置し，Kinect に向かって

距離を記録しているため，直交座標系に変換して描画

歩行したときの歩行者の足首の高さの距離画像と骨格

する．あらかじめ取得した背景画像との差分をとった

情報を記録する．取得した距離情報は複数枚を重ね合

後，過去の画像を重ね合わせて MHI を作成して動き

わせてモーションヒストリイメージ (MHI) を作成す

の可視化を行う．MHI は数フレームの距離情報を 1 つ

る．また，骨格情報は学習のために正規化を行う．こ

の画像にまとめたもので，動きが新しい距離情報は白

れらを，足首の高さの距離情報のみから人の三次元骨

く，古くなるにつれて黒く表示される．MHI を用いる

格座標を推定する深層ニューラルネットモデルの学習

ことで時系列での動きを表すことができ，1 枚の画像

に用いる (図 1)．

から人の足の動きの情報を得ることができる．最後に，
作成した画像の重心を求め 100 × 100 画素の範囲に切
り抜いて学習に使用する．骨格情報は，Kinect センサ
からの距離や個人差など条件が異なっているため，取
得した骨格情報の腰の座標を原点とし，腰と首の距離
を基準とするスケーリングを行い，学習に使用する．

4.
図 1: 2D-LiDAR を用いた全身骨格推定システム

三次元骨格推定

本稿では，歩行者正面と右側から取得した距離デー
タを使用して骨格を推定した．モデルは ImageNet で

事前学習済みの 18 層の ResNet を基礎とし，MHI を
入力として全 25 点の三次元骨格座標を出力とする回
帰学習を行う．エポック数は 100，学習率は 1.0×10−5
に設定した．8 人のデータのうち 1 人をテストデータ
とし，残り 7 人のデータを学習データとして，単一方
向データのみを使用した学習と，二方向からのデータ
を両方使用した学習の二パターンの学習を実施した．

4.1

損失関数での重みづけ

歩容認識においては手足の動かし方が重要な情報
となるが，一般に回帰学習で用いられる平均二乗誤差

図 4: 二方向のデータを学習したときの推定結果

(MSE) では末端の動きを無視するような偏りが生じ
てしまう．そこで，推定結果と学習データの誤差の大

正面データだけでなく右側データも学習した場合は、

きさに従って重みづけがされる損失関数を新たに定義

誤差の大きい骨格点が出力された．また，歩行 1 回分

した．p̂ を推定した関節点、p を正解の関節点，N を

の推定結果を動画にしてみると，それぞれの関節点が

関節点の数としたとき，損失 L を式 (1)〜(4) により

振動しているように見えるだけで，推定が正しく行え

求める．

ていないことがわかった．この問題は，モデルが入力
データの向き情報と動き方の情報を分離認識できてい

4.2

di

=

p̂i − pi

(1)

ないことが理由と考えられる．したがって，回帰に加

Ei

=

(2)

えて向きも明示的に同時に推定することで問題を解決

wi

=

L

=

||di ||
Ei − minj (Ej )
+1
maxj (Ej ) − minj (Ej )
1 ∑
||wi di ||2
N

(3)
(4)

単一方向データによる学習結果

歩行者の正面と右側からそれぞれ取得したデータを
使用して骨格推定を行った．右足を前に出した瞬間を
右側から計測した MHI を入力したときの推定骨格情
報を青色，MHI を取得したときに Kinect が取得した
骨格を赤色でプロットした（図 3）．左手と右足が前
に出ており，歩行している様子が推定できている．

できる可能性がある．

5.

おわりに

本稿では，2D-LiDAR の足元計測データを使用した
三次元骨格推定手法を提案した．歩行者の正面や右側
から取得した距離データを単一方向のみ使用した推定
では実際に人が歩行しているように見える程度で推定
できていた．しかし，二種類の方向を同時に使用した
推定では期待通りの結果とはならなかった．
今後は，歩行者の正面以外から取得した距離データ
からの骨格推定精度が向上する手法の検討を行いたい．
また，複数の方向からの距離データを入力する際には，
方向を識別した後に座標の推定をすることで推定の精
度が上がるか検証を行いたい．

外部発表
[P1] 須田悠介，鈴木亮太，小林貴訓， 2D-LiDAR
による足元計測に基づく全身骨格推定， 2023
年電子情報通信学会総合大会，2023.
図 3: 足元計測データを入力したときの全身骨格推定

参考文献

結果

[1] M. Hasan et al. Person tracking using ankle-level
二方向からの距離データによる学習結果

lidar based on enhanced dbscan and optics. IEEJ

次にネットワークは前節のまま正面と右側のデータ

transactions on electrical and electronic engineer-

4.3

を同時に学習し骨格を推定した．左足を前に出した瞬
間を正面から計測した MHI を入力したときの推定骨
格情報を青色，MHI を取得したときに Kinect が取得
した骨格を赤色でプロットした (図 4)．

ing, 16(5):778–786, 2021.

